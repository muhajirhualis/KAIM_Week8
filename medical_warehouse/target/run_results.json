{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.11.2", "generated_at": "2026-01-22T18:35:21.852919Z", "invocation_id": "79de83fb-1e0a-4202-8f2e-2cb725b177dc", "invocation_started_at": "2026-01-22T18:35:00.627656Z", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-22T18:35:20.259800Z", "completed_at": "2026-01-22T18:35:20.288681Z"}, {"name": "execute", "started_at": "2026-01-22T18:35:20.291414Z", "completed_at": "2026-01-22T18:35:20.729291Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.47295475006103516, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.medical_warehouse.stg_telegram_messages", "compiled": true, "compiled_code": "-- models/staging/stg_telegram_messages.sql\r\nSELECT\r\n    message_id::BIGINT,\r\n    channel_name::TEXT,\r\n    channel_title::TEXT,\r\n    message_date::TIMESTAMP,\r\n    message_text::TEXT,\r\n    has_media::BOOLEAN,\r\n    image_path::TEXT,\r\n    views::INTEGER,\r\n    forwards::INTEGER,\r\n    LENGTH(message_text) AS message_length\r\nFROM raw.telegram_messages\r\nWHERE message_id IS NOT NULL\r\n  AND message_date IS NOT NULL\r\n  AND message_date <= NOW()  -- no future dates", "relation_name": "\"medical_telegram_db\".\"public\".\"stg_telegram_messages\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-22T18:35:20.792926Z", "completed_at": "2026-01-22T18:35:20.805217Z"}, {"name": "execute", "started_at": "2026-01-22T18:35:20.845602Z", "completed_at": "2026-01-22T18:35:21.096715Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.31899189949035645, "adapter_response": {"_message": "SELECT 4", "code": "SELECT", "rows_affected": 4}, "message": "SELECT 4", "failures": null, "unique_id": "model.medical_warehouse.dim_channels", "compiled": true, "compiled_code": "-- models/marts/dim_channels.sql\nWITH channels AS (\n    SELECT DISTINCT\n        channel_name,\n        channel_title,\n        MIN(message_date) AS first_post_date,\n        MAX(message_date) AS last_post_date,\n        COUNT(*) AS total_posts,\n        AVG(views) AS avg_views\n    FROM \"medical_telegram_db\".\"public\".\"stg_telegram_messages\"\n    GROUP BY channel_name, channel_title\n),\nclassified AS (\n    SELECT *,\n        CASE\n            WHEN LOWER(channel_name) LIKE '%pharma%' THEN 'Pharmaceutical'\n            WHEN LOWER(channel_name) LIKE '%cosmetic%' THEN 'Cosmetics'\n            ELSE 'Medical'\n        END AS channel_type\n    FROM channels\n)\nSELECT\n    ROW_NUMBER() OVER (ORDER BY channel_name) AS channel_key,\n    channel_name,\n    channel_title,\n    channel_type,\n    first_post_date,\n    last_post_date,\n    total_posts,\n    avg_views\nFROM classified", "relation_name": "\"medical_telegram_db\".\"public\".\"dim_channels\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-22T18:35:20.785834Z", "completed_at": "2026-01-22T18:35:20.803809Z"}, {"name": "execute", "started_at": "2026-01-22T18:35:20.805984Z", "completed_at": "2026-01-22T18:35:21.101587Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.3267955780029297, "adapter_response": {"_message": "SELECT 1161", "code": "SELECT", "rows_affected": 1161}, "message": "SELECT 1161", "failures": null, "unique_id": "model.medical_warehouse.dim_dates", "compiled": true, "compiled_code": "-- models/marts/dim_dates.sql\n\n\nWITH dates AS (\n    SELECT\n        dd::DATE AS full_date\n    FROM generate_series(\n        (SELECT MIN(message_date)::DATE FROM \"medical_telegram_db\".\"public\".\"stg_telegram_messages\"),\n        (SELECT MAX(message_date)::DATE FROM \"medical_telegram_db\".\"public\".\"stg_telegram_messages\"),\n        '1 day'::INTERVAL\n    ) dd\n)\nSELECT\n    TO_CHAR(full_date, 'YYYYMMDD')::INT AS date_key,\n    full_date,\n    EXTRACT(DOW FROM full_date) AS day_of_week,\n    TO_CHAR(full_date, 'Day') AS day_name,\n    EXTRACT(WEEK FROM full_date) AS week_of_year,\n    EXTRACT(MONTH FROM full_date) AS month,\n    TO_CHAR(full_date, 'Month') AS month_name,\n    EXTRACT(QUARTER FROM full_date) AS quarter,\n    EXTRACT(YEAR FROM full_date) AS year,\n    CASE WHEN EXTRACT(DOW FROM full_date) IN (0,6) THEN TRUE ELSE FALSE END AS is_weekend\nFROM dates", "relation_name": "\"medical_telegram_db\".\"public\".\"dim_dates\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-22T18:35:21.119919Z", "completed_at": "2026-01-22T18:35:21.125863Z"}, {"name": "execute", "started_at": "2026-01-22T18:35:21.127506Z", "completed_at": "2026-01-22T18:35:21.436033Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.31853199005126953, "adapter_response": {"_message": "SELECT 200", "code": "SELECT", "rows_affected": 200}, "message": "SELECT 200", "failures": null, "unique_id": "model.medical_warehouse.fct_messages", "compiled": true, "compiled_code": "-- models/marts/fct_messages.sql\nSELECT\n    s.message_id,\n    d.channel_key,\n    dt.date_key,\n    s.message_text,\n    s.message_length,\n    s.views AS view_count,\n    s.forwards AS forward_count,\n    s.has_media AS has_image\nFROM \"medical_telegram_db\".\"public\".\"stg_telegram_messages\" s\nJOIN \"medical_telegram_db\".\"public\".\"dim_channels\" d ON s.channel_name = d.channel_name\nJOIN \"medical_telegram_db\".\"public\".\"dim_dates\" dt ON s.message_date::DATE = dt.full_date", "relation_name": "\"medical_telegram_db\".\"public\".\"fct_messages\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-22T18:35:21.443254Z", "completed_at": "2026-01-22T18:35:21.451724Z"}, {"name": "execute", "started_at": "2026-01-22T18:35:21.453226Z", "completed_at": "2026-01-22T18:35:21.610593Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.16926240921020508, "adapter_response": {"_message": "SELECT 148", "code": "SELECT", "rows_affected": 148}, "message": "SELECT 148", "failures": null, "unique_id": "model.medical_warehouse.fct_image_detections", "compiled": true, "compiled_code": "-- This links YOLO results to star schema via message_id.\nWITH yolo AS (\n    SELECT\n        message_id,\n        image_category,\n        max_confidence\n    FROM enriched.yolo_detections\n),\n\nmessages AS (\n    SELECT\n        message_id,\n        channel_key,\n        date_key\n    FROM \"medical_telegram_db\".\"public\".\"fct_messages\"\n)\n\nSELECT\n    y.message_id,\n    m.channel_key,\n    m.date_key,\n    y.image_category AS detected_class,\n    y.max_confidence AS confidence_score,\n    y.image_category\nFROM yolo y\nJOIN messages m ON y.message_id = m.message_id", "relation_name": "\"medical_telegram_db\".\"public\".\"fct_image_detections\"", "batch_results": null}], "elapsed_time": 8.67196011543274, "args": {"state_modified_compare_vars": false, "use_fast_test_edges": false, "favor_state": false, "log_level": "info", "use_colors_file": true, "exclude": [], "require_all_warnings_handled_by_warn_error": false, "skip_nodes_if_on_run_start_fails": false, "require_explicit_package_overrides_for_builtin_materializations": true, "vars": {}, "partial_parse_file_diff": true, "cache_selected_only": false, "invocation_command": "dbt run", "source_freshness_run_project_hooks": true, "write_json": true, "require_unique_project_resource_names": false, "log_format_file": "debug", "print": true, "upload_to_artifacts_ingest_api": false, "log_file_max_bytes": 10485760, "require_batched_execution_for_custom_microbatch_strategy": false, "show_all_deprecations": false, "introspect": true, "send_anonymous_usage_stats": true, "log_level_file": "debug", "which": "run", "defer": false, "log_format": "default", "require_resource_names_without_spaces": true, "version_check": true, "select": [], "partial_parse": true, "warn_error_options": {"error": [], "warn": [], "silence": []}, "printer_width": 80, "empty": false, "quiet": false, "macro_debugging": false, "show_resource_report": false, "populate_cache": true, "require_yaml_configuration_for_mf_time_spines": false, "require_nested_cumulative_type_params": false, "indirect_selection": "eager", "require_ref_searches_node_package_before_root": false, "log_path": "E:\\DS_Courses\\KAIM_10_Academy\\KAIM_8\\Week_8\\KAIM_Week8\\medical_warehouse\\logs", "project_dir": "E:\\DS_Courses\\KAIM_10_Academy\\KAIM_8\\Week_8\\KAIM_Week8\\medical_warehouse", "profiles_dir": "E:\\DS_Courses\\KAIM_10_Academy\\KAIM_8\\Week_8\\KAIM_Week8\\medical_warehouse", "use_colors": true, "static_parser": true, "strict_mode": false, "validate_macro_args": false, "require_generic_test_arguments_property": true, "state_modified_compare_more_unrendered_values": false}}