{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.11.2", "generated_at": "2026-01-22T20:19:08.445407Z", "invocation_id": "f3bdb06d-21ae-4e08-8e31-57fdce9ebaba", "invocation_started_at": "2026-01-22T20:18:44.364257Z", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-22T20:19:05.537670Z", "completed_at": "2026-01-22T20:19:05.560536Z"}, {"name": "execute", "started_at": "2026-01-22T20:19:05.562015Z", "completed_at": "2026-01-22T20:19:06.455075Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.9248838424682617, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.medical_warehouse.stg_telegram_messages", "compiled": true, "compiled_code": "-- models/staging/stg_telegram_messages.sql\r\nSELECT\r\n    message_id::BIGINT,\r\n    channel_name::TEXT,\r\n    channel_title::TEXT,\r\n    message_date::TIMESTAMP,\r\n    message_text::TEXT,\r\n    has_media::BOOLEAN,\r\n    image_path::TEXT,\r\n    views::INTEGER,\r\n    forwards::INTEGER,\r\n    LENGTH(message_text) AS message_length\r\nFROM raw.telegram_messages\r\nWHERE message_id IS NOT NULL\r\n  AND message_date IS NOT NULL\r\n  AND message_date <= NOW()  -- no future dates", "relation_name": "\"medical_telegram_db\".\"public\".\"stg_telegram_messages\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-22T20:19:06.503559Z", "completed_at": "2026-01-22T20:19:06.537992Z"}, {"name": "execute", "started_at": "2026-01-22T20:19:06.539413Z", "completed_at": "2026-01-22T20:19:07.424705Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.953665018081665, "adapter_response": {"_message": "SELECT 1161", "code": "SELECT", "rows_affected": 1161}, "message": "SELECT 1161", "failures": null, "unique_id": "model.medical_warehouse.dim_dates", "compiled": true, "compiled_code": "-- models/marts/dim_dates.sql\n\n\nWITH dates AS (\n    SELECT\n        dd::DATE AS full_date\n    FROM generate_series(\n        (SELECT MIN(message_date)::DATE FROM \"medical_telegram_db\".\"public\".\"stg_telegram_messages\"),\n        (SELECT MAX(message_date)::DATE FROM \"medical_telegram_db\".\"public\".\"stg_telegram_messages\"),\n        '1 day'::INTERVAL\n    ) dd\n)\nSELECT\n    TO_CHAR(full_date, 'YYYYMMDD')::INT AS date_key,\n    full_date,\n    EXTRACT(DOW FROM full_date) AS day_of_week,\n    TO_CHAR(full_date, 'Day') AS day_name,\n    EXTRACT(WEEK FROM full_date) AS week_of_year,\n    EXTRACT(MONTH FROM full_date) AS month,\n    TO_CHAR(full_date, 'Month') AS month_name,\n    EXTRACT(QUARTER FROM full_date) AS quarter,\n    EXTRACT(YEAR FROM full_date) AS year,\n    CASE WHEN EXTRACT(DOW FROM full_date) IN (0,6) THEN TRUE ELSE FALSE END AS is_weekend\nFROM dates", "relation_name": "\"medical_telegram_db\".\"public\".\"dim_dates\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-22T20:19:06.492434Z", "completed_at": "2026-01-22T20:19:06.514906Z"}, {"name": "execute", "started_at": "2026-01-22T20:19:06.516613Z", "completed_at": "2026-01-22T20:19:07.477527Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.9988956451416016, "adapter_response": {"_message": "SELECT 4", "code": "SELECT", "rows_affected": 4}, "message": "SELECT 4", "failures": null, "unique_id": "model.medical_warehouse.dim_channels", "compiled": true, "compiled_code": "-- models/marts/dim_channels.sql\nWITH channels AS (\n    SELECT DISTINCT\n        channel_name,\n        channel_title,\n        MIN(message_date) AS first_post_date,\n        MAX(message_date) AS last_post_date,\n        COUNT(*) AS total_posts,\n        AVG(views) AS avg_views\n    FROM \"medical_telegram_db\".\"public\".\"stg_telegram_messages\"\n    GROUP BY channel_name, channel_title\n),\nclassified AS (\n    SELECT *,\n        CASE\n            WHEN LOWER(channel_name) LIKE '%pharma%' THEN 'Pharmaceutical'\n            WHEN LOWER(channel_name) LIKE '%cosmetic%' THEN 'Cosmetics'\n            ELSE 'Medical'\n        END AS channel_type\n    FROM channels\n)\nSELECT\n    ROW_NUMBER() OVER (ORDER BY channel_name) AS channel_key,\n    channel_name,\n    channel_title,\n    channel_type,\n    first_post_date,\n    last_post_date,\n    total_posts,\n    avg_views\nFROM classified", "relation_name": "\"medical_telegram_db\".\"public\".\"dim_channels\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-22T20:19:07.496066Z", "completed_at": "2026-01-22T20:19:07.508996Z"}, {"name": "execute", "started_at": "2026-01-22T20:19:07.510694Z", "completed_at": "2026-01-22T20:19:07.946129Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.45548272132873535, "adapter_response": {"_message": "SELECT 200", "code": "SELECT", "rows_affected": 200}, "message": "SELECT 200", "failures": null, "unique_id": "model.medical_warehouse.fct_messages", "compiled": true, "compiled_code": "-- models/marts/fct_messages.sql\nSELECT\n    s.message_id,\n    d.channel_key,\n    dt.date_key,\n    s.message_text,\n    s.message_length,\n    s.views AS view_count,\n    s.forwards AS forward_count,\n    s.has_media AS has_image\nFROM \"medical_telegram_db\".\"public\".\"stg_telegram_messages\" s\nJOIN \"medical_telegram_db\".\"public\".\"dim_channels\" d ON s.channel_name = d.channel_name\nJOIN \"medical_telegram_db\".\"public\".\"dim_dates\" dt ON s.message_date::DATE = dt.full_date", "relation_name": "\"medical_telegram_db\".\"public\".\"fct_messages\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-22T20:19:07.988003Z", "completed_at": "2026-01-22T20:19:07.997133Z"}, {"name": "execute", "started_at": "2026-01-22T20:19:07.998845Z", "completed_at": "2026-01-22T20:19:08.262274Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.3028984069824219, "adapter_response": {"_message": "SELECT 148", "code": "SELECT", "rows_affected": 148}, "message": "SELECT 148", "failures": null, "unique_id": "model.medical_warehouse.fct_image_detections", "compiled": true, "compiled_code": "-- This links YOLO results to star schema via message_id.\nWITH yolo AS (\n    SELECT\n        message_id,\n        image_category,\n        max_confidence\n    FROM enriched.yolo_detections\n),\n\nmessages AS (\n    SELECT\n        message_id,\n        channel_key,\n        date_key\n    FROM \"medical_telegram_db\".\"public\".\"fct_messages\"\n)\n\nSELECT\n    y.message_id,\n    m.channel_key,\n    m.date_key,\n    y.image_category AS detected_class,\n    y.max_confidence AS confidence_score,\n    y.image_category\nFROM yolo y\nJOIN messages m ON y.message_id = m.message_id", "relation_name": "\"medical_telegram_db\".\"public\".\"fct_image_detections\"", "batch_results": null}], "elapsed_time": 6.614387035369873, "args": {"quiet": false, "introspect": true, "require_explicit_package_overrides_for_builtin_materializations": true, "cache_selected_only": false, "log_level": "info", "profiles_dir": "E:\\DS_Courses\\KAIM_10_Academy\\KAIM_8\\Week_8\\KAIM_Week8\\medical_warehouse", "select": [], "printer_width": 80, "send_anonymous_usage_stats": true, "favor_state": false, "validate_macro_args": false, "log_file_max_bytes": 10485760, "indirect_selection": "eager", "require_yaml_configuration_for_mf_time_spines": false, "skip_nodes_if_on_run_start_fails": false, "strict_mode": false, "exclude": [], "use_colors_file": true, "show_resource_report": false, "populate_cache": true, "upload_to_artifacts_ingest_api": false, "warn_error_options": {"error": [], "warn": [], "silence": []}, "which": "run", "invocation_command": "dbt run --project-dir E:\\DS_Courses\\KAIM_10_Academy\\KAIM_8\\Week_8\\KAIM_Week8\\medical_warehouse --profiles-dir E:\\DS_Courses\\KAIM_10_Academy\\KAIM_8\\Week_8\\KAIM_Week8\\medical_warehouse", "write_json": true, "vars": {}, "require_ref_searches_node_package_before_root": false, "use_fast_test_edges": false, "source_freshness_run_project_hooks": true, "use_colors": true, "partial_parse": true, "log_level_file": "debug", "print": true, "show_all_deprecations": false, "require_nested_cumulative_type_params": false, "defer": false, "require_generic_test_arguments_property": true, "state_modified_compare_vars": false, "project_dir": "E:\\DS_Courses\\KAIM_10_Academy\\KAIM_8\\Week_8\\KAIM_Week8\\medical_warehouse", "state_modified_compare_more_unrendered_values": false, "log_format": "default", "empty": false, "log_format_file": "debug", "log_path": "E:\\DS_Courses\\KAIM_10_Academy\\KAIM_8\\Week_8\\KAIM_Week8\\medical_warehouse\\logs", "macro_debugging": false, "require_batched_execution_for_custom_microbatch_strategy": false, "require_resource_names_without_spaces": true, "require_unique_project_resource_names": false, "partial_parse_file_diff": true, "version_check": true, "require_all_warnings_handled_by_warn_error": false, "static_parser": true}}